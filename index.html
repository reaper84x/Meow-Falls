<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meow Falls</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Nunito', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(to bottom, #F4E1D2, #F1D3C4); /* Creamy color palette */
            color: #333;
            height: 100vh;
        }
        canvas {
            border: 3px solid #fff;
            background-color: #F1D3C4;
        }
        #score {
            position: absolute;
            top: 20px;
            font-size: 20px;
            left: 20px;
            font-weight: bold;
        }
        #gameOver {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 30px;
            color: red;
            display: none;
        }
        #restart {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            color: #fff;
            background-color: #008CBA;
            padding: 10px;
            cursor: pointer;
            display: none;
        }
        #pauseMenu {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            display: none;
        }
        #greetingPopup {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #FFF;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            display: none;
        }
        #startButton {
            background-color: #ff6347;
            border: none;
            color: white;
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="400" height="600"></canvas>
    <div id="score">Score: 0</div>
    <div id="gameOver">Game Over!</div>
    <div id="restart" onclick="startGame()">Restart</div>
    <div id="pauseMenu">
        <h2>Game Paused</h2>
        <button onclick="resumeGame()">Resume</button><br><br>
        <button onclick="startGame()">Restart</button>
    </div>
    <div id="greetingPopup">
        <p>Welcome to <strong>Meow Falls!</strong></p>
        <p>Catch the falling kittens, avoid the ones that fall!</p>
        <p><em>Game Created by Salman Groovin</em></p>
        <button id="startButton">Start Game</button>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        let score = 0;
        let gameInterval;
        let fallingKittens = [];
        let speed = 2; // Initial speed
        let isGameOver = false;
        let isPaused = false;

        const basketImg = new Image();
        basketImg.src = "https://i.postimg.cc/JskVfNPf/basket.png";

        const kittenImg = new Image();
        kittenImg.src = "https://i.postimg.cc/sv1RcdSD/cat.png";

        const goldenKittenImg = new Image();
        goldenKittenImg.src = "https://i.postimg.cc/sv1RcdSD/cat.png"; // Golden kitten can be a different image if needed

        const basket = {
            x: canvas.width / 2 - 35,
            y: canvas.height - 70,
            width: 70,
            height: 60,
        };

        class Kitten {
            constructor(x, y, speed, isGolden = false) {
                this.x = x;
                this.y = y;
                this.speed = speed;
                this.size = 50;
                this.isGolden = isGolden;
            }

            draw() {
                const img = this.isGolden ? goldenKittenImg : kittenImg;
                ctx.drawImage(img, this.x, this.y, this.size, this.size);
            }

            update() {
                this.y += this.speed;
            }
        }

        function spawnKitten() {
            const x = Math.random() * (canvas.width - 50);
            const isGolden = Math.random() < 0.1; // 10% chance for a golden kitten
            fallingKittens.push(new Kitten(x, 0, speed, isGolden));
        }

        function detectCollision(kitten) {
            return (
                kitten.x < basket.x + basket.width &&
                kitten.x + kitten.size > basket.x &&
                kitten.y + kitten.size > basket.y &&
                kitten.y < basket.y + basket.height
            );
        }

        function updateGame() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(basketImg, basket.x, basket.y, basket.width, basket.height);

            fallingKittens.forEach((kitten, index) => {
                kitten.update();
                kitten.draw();

                if (kitten.y > canvas.height) {
                    fallingKittens.splice(index, 1);
                    // End game when a kitten is missed
                    endGame();
                } else if (detectCollision(kitten)) {
                    score += kitten.isGolden ? 5 : 1;
                    fallingKittens.splice(index, 1);
                    document.getElementById("score").innerText = `Score: ${score}`;

                    // Increase speed every 10 points
                    if (score % 10 === 0) {
                        speed += 0.5;
                    }
                }
            });

            if (Math.random() < 0.02) spawnKitten();
        }

        function startGame() {
            score = 0;
            isGameOver = false;
            isPaused = false;
            document.getElementById("score").innerText = `Score: ${score}`;
            document.getElementById("gameOver").style.display = "none";
            document.getElementById("restart").style.display = "none";
            document.getElementById("pauseMenu").style.display = "none";
            fallingKittens = [];
            speed = 2;
            gameInterval = setInterval(updateGame, 20);
        }

        function endGame() {
            isGameOver = true;
            clearInterval(gameInterval);
            document.getElementById("gameOver").style.display = "block";
            document.getElementById("restart").style.display = "block";
        }

        function resumeGame() {
            isPaused = false;
            gameInterval = setInterval(updateGame, 20);
            document.getElementById("pauseMenu").style.display = "none";
        }

        document.getElementById("startButton").addEventListener("click", () => {
            document.getElementById("greetingPopup").style.display = "none";
            startGame();
        });

        function togglePauseMenu() {
            isPaused = !isPaused;
            if (isPaused) {
                clearInterval(gameInterval);
                document.getElementById("pauseMenu").style.display = "block";
            } else {
                resumeGame();
            }
        }

        window.onload = function () {
            document.getElementById("greetingPopup").style.display = "block";
        };

        window.addEventListener("keydown", (event) => {
            if (event.key === "p" || event.key === "P") {
                togglePauseMenu();
            }
        });

        canvas.addEventListener("touchmove", (event) => {
            event.preventDefault();
            const touchX = event.touches[0].clientX;
            const rect = canvas.getBoundingClientRect();
            const canvasX = touchX - rect.left;
            basket.x = Math.min(canvas.width - basket.width, Math.max(0, canvasX - basket.width / 2));
        }, { passive: false });

    </script>
</body>
</html>
